<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance Monitoring Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #2d3748;
            min-height: 100vh;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1.5rem 2rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .header h1 {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }
        
        .header p {
            color: #4a5568;
            font-size: 1rem;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.2s ease;
        }
        
        .card:hover {
            transform: translateY(-2px);
        }
        
        .card h3 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #2d3748;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .performance-indicator {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .performance-indicator:last-child {
            border-bottom: none;
        }
        
        .indicator-label {
            font-weight: 500;
            color: #4a5568;
        }
        
        .indicator-value {
            font-weight: 700;
            font-size: 1.1rem;
        }
        
        .fps-indicator {
            color: #38a169;
        }
        
        .fps-indicator.warning {
            color: #d69e2e;
        }
        
        .fps-indicator.critical {
            color: #e53e3e;
        }
        
        .status-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .status-excellent {
            background: #c6f6d5;
            color: #22543d;
        }
        
        .status-good {
            background: #bee3f8;
            color: #2c5282;
        }
        
        .status-warning {
            background: #faf089;
            color: #744210;
        }
        
        .status-critical {
            background: #fed7d7;
            color: #742a2a;
        }
        
        .chart-container {
            width: 100%;
            height: 300px;
            margin-top: 1rem;
        }
        
        .real-time-section {
            margin: 2rem 0;
        }
        
        .controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: #e2e8f0;
            color: #4a5568;
        }
        
        .btn-secondary:hover {
            background: #cbd5e0;
        }
        
        .btn-danger {
            background: #fc8181;
            color: #742a2a;
        }
        
        .btn-danger:hover {
            background: #f56565;
        }
        
        .real-time-fps {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            margin-bottom: 1rem;
        }
        
        .fps-display {
            font-size: 3rem;
            font-weight: 700;
            line-height: 1;
        }
        
        .fps-label {
            font-size: 0.875rem;
            color: #4a5568;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .device-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }
        
        .device-info-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 0.75rem;
            border-radius: 8px;
            text-align: center;
        }
        
        .device-info-label {
            font-size: 0.75rem;
            color: #4a5568;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.25rem;
        }
        
        .device-info-value {
            font-size: 1.25rem;
            font-weight: 600;
        }
        
        .alerts-section {
            margin-top: 2rem;
        }
        
        .alert {
            padding: 1rem;
            border-radius: 12px;
            margin-bottom: 1rem;
            border-left: 4px solid;
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
        }
        
        .alert-warning {
            background: rgba(250, 240, 137, 0.2);
            border-color: #d69e2e;
            color: #744210;
        }
        
        .alert-critical {
            background: rgba(254, 215, 215, 0.2);
            border-color: #e53e3e;
            color: #742a2a;
        }
        
        .alert-info {
            background: rgba(190, 227, 248, 0.2);
            border-color: #3182ce;
            color: #2c5282;
        }
        
        .alert-icon {
            flex-shrink: 0;
            margin-top: 0.125rem;
        }
        
        .recommendations {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 1rem;
        }
        
        .recommendations h4 {
            margin-bottom: 1rem;
            color: #2d3748;
        }
        
        .recommendation-item {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }
        
        .recommendation-item:last-child {
            margin-bottom: 0;
        }
        
        .footer {
            text-align: center;
            padding: 2rem;
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.875rem;
        }
        
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
            color: #4a5568;
        }
        
        .spinner {
            width: 32px;
            height: 32px;
            border: 3px solid rgba(102, 126, 234, 0.3);
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 1rem;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .error {
            background: rgba(254, 215, 215, 0.2);
            color: #742a2a;
            padding: 1.5rem;
            border-radius: 12px;
            text-align: center;
            border: 1px solid rgba(229, 62, 62, 0.3);
        }
        
        @media (max-width: 768px) {
            .header {
                padding: 1rem;
            }
            
            .header h1 {
                font-size: 1.5rem;
            }
            
            .container {
                padding: 1rem;
            }
            
            .metrics-grid {
                grid-template-columns: 1fr;
            }
            
            .controls {
                flex-direction: column;
            }
            
            .fps-display {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üéÆ Performance Monitoring Dashboard</h1>
        <p>Real-time monitoring: 60fps desktop ‚Ä¢ 30fps mobile targets</p>
    </div>
    
    <div class="container">
        <div id="loading" class="loading">
            <div class="spinner"></div>
            <div>Loading performance data...</div>
        </div>
        
        <div id="error" class="error" style="display: none;">
            <h3>‚ö†Ô∏è Unable to load performance data</h3>
            <p>Make sure the performance monitoring system is running.</p>
        </div>
        
        <div id="dashboard" style="display: none;">
            <!-- Real-time Performance Section -->
            <div class="real-time-section">
                <div class="card">
                    <h3>‚ö° Real-time Performance</h3>
                    
                    <div class="controls">
                        <button class="btn btn-primary" onclick="startMonitoring()">
                            <span>‚ñ∂Ô∏è</span> Start Monitoring
                        </button>
                        <button class="btn btn-secondary" onclick="stopMonitoring()">
                            <span>‚èπÔ∏è</span> Stop
                        </button>
                        <button class="btn btn-secondary" onclick="runPerformanceTest()">
                            <span>üß™</span> Run Test
                        </button>
                        <button class="btn btn-danger" onclick="runStressTest()">
                            <span>üî•</span> Stress Test
                        </button>
                    </div>
                    
                    <div class="real-time-fps">
                        <div>
                            <div class="fps-display" id="current-fps">--</div>
                            <div class="fps-label">Current FPS</div>
                        </div>
                        <div>
                            <div class="fps-display" id="target-fps">60</div>
                            <div class="fps-label">Target FPS</div>
                        </div>
                        <div>
                            <div class="fps-display" id="frame-drops">0</div>
                            <div class="fps-label">Frame Drops</div>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <canvas id="realTimeChart"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- Performance Metrics Grid -->
            <div class="metrics-grid">
                <!-- Current Performance -->
                <div class="card">
                    <h3>üìä Current Performance</h3>
                    <div id="current-performance">
                        <!-- Dynamically populated -->
                    </div>
                </div>
                
                <!-- Device Information -->
                <div class="card">
                    <h3>üíª Device Information</h3>
                    <div id="device-info">
                        <!-- Dynamically populated -->
                    </div>
                </div>
                
                <!-- Performance Status -->
                <div class="card">
                    <h3>üö¶ Performance Status</h3>
                    <div id="performance-status">
                        <!-- Dynamically populated -->
                    </div>
                </div>
                
                <!-- Memory Usage -->
                <div class="card">
                    <h3>üß† Memory Usage</h3>
                    <div class="chart-container">
                        <canvas id="memoryChart"></canvas>
                    </div>
                </div>
                
                <!-- FPS Trends -->
                <div class="card">
                    <h3>üìà FPS Trends</h3>
                    <div class="chart-container">
                        <canvas id="fpsChart"></canvas>
                    </div>
                </div>
                
                <!-- Performance History -->
                <div class="card">
                    <h3>üìã Performance History</h3>
                    <div id="performance-history">
                        <!-- Dynamically populated -->
                    </div>
                </div>
            </div>
            
            <!-- Alerts Section -->
            <div id="alerts" class="alerts-section">
                <!-- Dynamically populated -->
            </div>
            
            <!-- Recommendations -->
            <div class="recommendations">
                <h4>üí° Performance Recommendations</h4>
                <div id="recommendations">
                    <!-- Dynamically populated -->
                </div>
            </div>
        </div>
    </div>
    
    <div class="footer">
        <p>Performance Dashboard - Last updated: <span id="last-updated"></span></p>
    </div>

    <script>
        // Performance Dashboard JavaScript
        class PerformanceDashboard {
            constructor() {
                this.isMonitoring = false;
                this.currentFPS = 0;
                this.frameHistory = [];
                this.memoryHistory = [];
                this.alerts = [];
                this.charts = {};
                this.deviceInfo = null;
                this.performanceData = null;
                this.monitoringInterval = null;
                
                this.init();
            }
            
            async init() {
                try {
                    await this.loadPerformanceData();
                    await this.detectDevice();
                    this.setupCharts();
                    this.render();
                    this.startAutoUpdate();
                } catch (error) {
                    this.showError();
                    console.error('Dashboard initialization failed:', error);
                }
            }
            
            async loadPerformanceData() {
                // Try to load existing performance data
                try {
                    const response = await fetch('./performance-summary.json');
                    if (response.ok) {
                        this.performanceData = await response.json();
                    }
                } catch (error) {
                    console.warn('No performance data available, using defaults');
                    this.performanceData = this.getDefaultPerformanceData();
                }
            }
            
            async detectDevice() {
                this.deviceInfo = {
                    type: this.getDeviceType(),
                    userAgent: navigator.userAgent,
                    viewport: {
                        width: window.innerWidth,
                        height: window.innerHeight,
                    },
                    screen: {
                        width: screen.width,
                        height: screen.height,
                        colorDepth: screen.colorDepth,
                        pixelDepth: screen.pixelDepth,
                    },
                    devicePixelRatio: window.devicePixelRatio || 1,
                    hardwareConcurrency: navigator.hardwareConcurrency || 'Unknown',
                    maxTouchPoints: navigator.maxTouchPoints || 0,
                    connection: this.getConnectionInfo(),
                    memory: this.getMemoryInfo(),
                    gpu: await this.getGPUInfo(),
                    webglSupport: this.checkWebGLSupport(),
                };
            }
            
            getDeviceType() {
                const width = window.innerWidth;
                if (width <= 768) return 'mobile';
                if (width <= 1024) return 'tablet';
                return 'desktop';
            }
            
            getConnectionInfo() {
                if ('connection' in navigator) {
                    const conn = navigator.connection;
                    return {
                        effectiveType: conn.effectiveType || 'unknown',
                        downlink: conn.downlink || 'unknown',
                        rtt: conn.rtt || 'unknown',
                        saveData: conn.saveData || false,
                    };
                }
                return { effectiveType: 'unknown' };
            }
            
            getMemoryInfo() {
                if ('memory' in performance) {
                    const memory = performance.memory;
                    return {
                        used: Math.round(memory.usedJSHeapSize / 1024 / 1024),
                        total: Math.round(memory.totalJSHeapSize / 1024 / 1024),
                        limit: Math.round(memory.jsHeapSizeLimit / 1024 / 1024),
                    };
                }
                return { used: 'Unknown', total: 'Unknown', limit: 'Unknown' };
            }
            
            async getGPUInfo() {
                try {
                    const canvas = document.createElement('canvas');
                    const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                    
                    if (gl) {
                        const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                        if (debugInfo) {
                            return {
                                vendor: gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL),
                                renderer: gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL),
                            };
                        }
                    }
                } catch (error) {
                    console.warn('Could not get GPU info:', error);
                }
                
                return { vendor: 'Unknown', renderer: 'Unknown' };
            }
            
            checkWebGLSupport() {
                try {
                    const canvas = document.createElement('canvas');
                    const webgl1 = !!(canvas.getContext('webgl') || canvas.getContext('experimental-webgl'));
                    const webgl2 = !!canvas.getContext('webgl2');
                    return { webgl1, webgl2 };
                } catch (error) {
                    return { webgl1: false, webgl2: false };
                }
            }
            
            getDefaultPerformanceData() {
                return {
                    validation: {
                        lastRun: new Date().toISOString(),
                        averageDesktopFPS: 58.5,
                        averageMobileFPS: 29.2,
                        passRate: 85.5,
                        overallPassed: true,
                    },
                };
            }
            
            setupCharts() {
                this.setupRealTimeChart();
                this.setupMemoryChart();
                this.setupFPSChart();
            }
            
            setupRealTimeChart() {
                const ctx = document.getElementById('realTimeChart').getContext('2d');
                
                this.charts.realTime = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [{
                            label: 'FPS',
                            data: [],
                            borderColor: '#667eea',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            tension: 0.4,
                            fill: true,
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        animation: { duration: 0 },
                        scales: {
                            x: {
                                display: false,
                            },
                            y: {
                                min: 0,
                                max: 70,
                                title: {
                                    display: true,
                                    text: 'FPS'
                                }
                            }
                        },
                        plugins: {
                            legend: { display: false }
                        }
                    }
                });
            }
            
            setupMemoryChart() {
                const ctx = document.getElementById('memoryChart').getContext('2d');
                const memInfo = this.deviceInfo?.memory;
                
                if (memInfo && memInfo.used !== 'Unknown') {
                    this.charts.memory = new Chart(ctx, {
                        type: 'doughnut',
                        data: {
                            labels: ['Used', 'Available'],
                            datasets: [{
                                data: [memInfo.used, memInfo.total - memInfo.used],
                                backgroundColor: ['#fc8181', '#68d391'],
                                borderWidth: 0,
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                }
                            }
                        }
                    });
                } else {
                    ctx.canvas.parentElement.innerHTML = '<p style="text-align: center; padding: 2rem; color: #4a5568;">Memory information not available</p>';
                }
            }
            
            setupFPSChart() {
                const ctx = document.getElementById('fpsChart').getContext('2d');
                
                // Generate sample historical data
                const labels = [];
                const data = [];
                const targetFPS = this.deviceInfo?.type === 'mobile' ? 30 : 60;
                
                for (let i = 29; i >= 0; i--) {
                    const date = new Date();
                    date.setMinutes(date.getMinutes() - i);
                    labels.push(date.toLocaleTimeString());
                    
                    // Generate realistic FPS data
                    const variation = (Math.random() - 0.5) * 10;
                    data.push(Math.max(10, targetFPS + variation));
                }
                
                this.charts.fps = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Average FPS',
                            data: data,
                            borderColor: '#38a169',
                            backgroundColor: 'rgba(56, 161, 105, 0.1)',
                            tension: 0.1,
                            fill: true,
                        }, {
                            label: 'Target FPS',
                            data: new Array(30).fill(targetFPS),
                            borderColor: '#667eea',
                            borderDash: [5, 5],
                            fill: false,
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                min: 0,
                                max: targetFPS * 1.2,
                                title: {
                                    display: true,
                                    text: 'FPS'
                                }
                            }
                        }
                    }
                });
            }
            
            render() {
                document.getElementById('loading').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';
                
                this.renderCurrentPerformance();
                this.renderDeviceInfo();
                this.renderPerformanceStatus();
                this.renderPerformanceHistory();
                this.renderAlerts();
                this.renderRecommendations();
                this.updateLastUpdated();
            }
            
            renderCurrentPerformance() {
                const container = document.getElementById('current-performance');
                const data = this.performanceData?.validation || {};
                
                container.innerHTML = `
                    <div class="performance-indicator">
                        <span class="indicator-label">Desktop FPS</span>
                        <span class="indicator-value fps-indicator">${data.averageDesktopFPS || '--'}</span>
                    </div>
                    <div class="performance-indicator">
                        <span class="indicator-label">Mobile FPS</span>
                        <span class="indicator-value fps-indicator">${data.averageMobileFPS || '--'}</span>
                    </div>
                    <div class="performance-indicator">
                        <span class="indicator-label">Pass Rate</span>
                        <span class="indicator-value">${data.passRate || '--'}%</span>
                    </div>
                    <div class="performance-indicator">
                        <span class="indicator-label">Memory Usage</span>
                        <span class="indicator-value">${this.deviceInfo?.memory?.used || '--'} MB</span>
                    </div>
                `;
            }
            
            renderDeviceInfo() {
                const container = document.getElementById('device-info');
                const info = this.deviceInfo;
                
                container.innerHTML = `
                    <div class="performance-indicator">
                        <span class="indicator-label">Device Type</span>
                        <span class="indicator-value">${info?.type || 'Unknown'}</span>
                    </div>
                    <div class="performance-indicator">
                        <span class="indicator-label">CPU Cores</span>
                        <span class="indicator-value">${info?.hardwareConcurrency || 'Unknown'}</span>
                    </div>
                    <div class="performance-indicator">
                        <span class="indicator-label">Pixel Ratio</span>
                        <span class="indicator-value">${info?.devicePixelRatio || 'Unknown'}</span>
                    </div>
                    <div class="performance-indicator">
                        <span class="indicator-label">WebGL Support</span>
                        <span class="indicator-value">${info?.webglSupport?.webgl2 ? 'WebGL2' : info?.webglSupport?.webgl1 ? 'WebGL1' : 'None'}</span>
                    </div>
                    <div class="performance-indicator">
                        <span class="indicator-label">Connection</span>
                        <span class="indicator-value">${info?.connection?.effectiveType || 'Unknown'}</span>
                    </div>
                `;
            }
            
            renderPerformanceStatus() {
                const container = document.getElementById('performance-status');
                const targetFPS = this.deviceInfo?.type === 'mobile' ? 30 : 60;
                const currentFPS = this.currentFPS || (this.deviceInfo?.type === 'mobile' ? 29.2 : 58.5);
                
                let status = 'excellent';
                let statusText = 'Excellent';
                
                if (currentFPS < targetFPS * 0.7) {
                    status = 'critical';
                    statusText = 'Critical';
                } else if (currentFPS < targetFPS * 0.8) {
                    status = 'warning';
                    statusText = 'Warning';
                } else if (currentFPS < targetFPS * 0.9) {
                    status = 'good';
                    statusText = 'Good';
                }
                
                container.innerHTML = `
                    <div class="performance-indicator">
                        <span class="indicator-label">Overall Status</span>
                        <span class="status-badge status-${status}">${statusText}</span>
                    </div>
                    <div class="performance-indicator">
                        <span class="indicator-label">Target FPS</span>
                        <span class="indicator-value">${targetFPS}</span>
                    </div>
                    <div class="performance-indicator">
                        <span class="indicator-label">Current FPS</span>
                        <span class="indicator-value fps-indicator ${status === 'critical' ? 'critical' : status === 'warning' ? 'warning' : ''}">${currentFPS.toFixed(1)}</span>
                    </div>
                    <div class="performance-indicator">
                        <span class="indicator-label">Performance Score</span>
                        <span class="indicator-value">${Math.round((currentFPS / targetFPS) * 100)}%</span>
                    </div>
                `;
            }
            
            renderPerformanceHistory() {
                const container = document.getElementById('performance-history');
                
                // Sample history data
                const history = [
                    { timestamp: '2 hours ago', fps: 58.2, status: 'good' },
                    { timestamp: '1 hour ago', fps: 59.1, status: 'excellent' },
                    { timestamp: '30 min ago', fps: 57.8, status: 'good' },
                    { timestamp: '10 min ago', fps: 58.5, status: 'good' },
                ];
                
                container.innerHTML = history.map(item => `
                    <div class="performance-indicator">
                        <span class="indicator-label">${item.timestamp}</span>
                        <span class="indicator-value fps-indicator ${item.status === 'excellent' ? '' : 'warning'}">${item.fps} FPS</span>
                    </div>
                `).join('');
            }
            
            renderAlerts() {
                const container = document.getElementById('alerts');
                
                // Sample alerts
                const alerts = [];
                
                if (this.currentFPS > 0 && this.currentFPS < (this.deviceInfo?.type === 'mobile' ? 25 : 50)) {
                    alerts.push({
                        type: 'critical',
                        message: 'Performance below target threshold',
                        description: 'Consider reducing animation complexity or enabling performance mode.',
                    });
                }
                
                if (this.deviceInfo?.memory?.used && this.deviceInfo.memory.used > 500) {
                    alerts.push({
                        type: 'warning',
                        message: 'High memory usage detected',
                        description: 'Memory usage is above 500MB. Monitor for potential memory leaks.',
                    });
                }
                
                if (alerts.length === 0) {
                    container.innerHTML = `
                        <div class="alert alert-info">
                            <div class="alert-icon">‚úÖ</div>
                            <div>
                                <strong>All systems operating normally</strong>
                                <p>No performance issues detected.</p>
                            </div>
                        </div>
                    `;
                } else {
                    container.innerHTML = alerts.map(alert => `
                        <div class="alert alert-${alert.type}">
                            <div class="alert-icon">${alert.type === 'critical' ? 'üö®' : '‚ö†Ô∏è'}</div>
                            <div>
                                <strong>${alert.message}</strong>
                                <p>${alert.description}</p>
                            </div>
                        </div>
                    `).join('');
                }
            }
            
            renderRecommendations() {
                const container = document.getElementById('recommendations');
                
                const recommendations = [];
                
                if (this.deviceInfo?.type === 'mobile') {
                    recommendations.push('Enable mobile optimization mode for better performance on mobile devices.');
                }
                
                if (this.deviceInfo?.connection?.effectiveType === '2g' || this.deviceInfo?.connection?.effectiveType === '3g') {
                    recommendations.push('Slow connection detected. Consider enabling data saving mode.');
                }
                
                if (!this.deviceInfo?.webglSupport?.webgl2) {
                    recommendations.push('WebGL2 not supported. Using WebGL1 fallback may impact performance.');
                }
                
                if (this.deviceInfo?.hardwareConcurrency < 4) {
                    recommendations.push('Low CPU core count detected. Consider reducing animation complexity.');
                }
                
                if (recommendations.length === 0) {
                    recommendations.push('Performance is optimal. No specific recommendations at this time.');
                }
                
                container.innerHTML = recommendations.map((rec, index) => `
                    <div class="recommendation-item">
                        <div style="color: #667eea; font-weight: bold;">${index + 1}.</div>
                        <div>${rec}</div>
                    </div>
                `).join('');
            }
            
            updateLastUpdated() {
                document.getElementById('last-updated').textContent = new Date().toLocaleString();
            }
            
            startAutoUpdate() {
                setInterval(() => {
                    this.updateLastUpdated();
                    
                    if (this.isMonitoring) {
                        this.updateRealTimeData();
                    }
                }, 1000);
            }
            
            updateRealTimeData() {
                // Simulate real-time FPS data
                const targetFPS = this.deviceInfo?.type === 'mobile' ? 30 : 60;
                const variation = (Math.random() - 0.5) * 8;
                this.currentFPS = Math.max(10, targetFPS + variation);
                
                // Update displays
                document.getElementById('current-fps').textContent = this.currentFPS.toFixed(1);
                document.getElementById('target-fps').textContent = targetFPS;
                
                // Update frame drops (simulated)
                const frameDrops = this.currentFPS < targetFPS * 0.8 ? Math.floor(Math.random() * 5) : 0;
                document.getElementById('frame-drops').textContent = frameDrops;
                
                // Update chart
                const chart = this.charts.realTime;
                const now = new Date().toLocaleTimeString();
                
                chart.data.labels.push(now);
                chart.data.datasets[0].data.push(this.currentFPS);
                
                // Keep only last 30 data points
                if (chart.data.labels.length > 30) {
                    chart.data.labels.shift();
                    chart.data.datasets[0].data.shift();
                }
                
                chart.update('none');
                
                // Update performance status
                this.renderPerformanceStatus();
            }
            
            showError() {
                document.getElementById('loading').style.display = 'none';
                document.getElementById('error').style.display = 'block';
            }
        }
        
        // Global functions for dashboard controls
        function startMonitoring() {
            dashboard.isMonitoring = true;
            console.log('Performance monitoring started');
        }
        
        function stopMonitoring() {
            dashboard.isMonitoring = false;
            console.log('Performance monitoring stopped');
        }
        
        function runPerformanceTest() {
            console.log('Running performance test...');
            // In real implementation, this would trigger the performance test suite
            alert('Performance test started. Check console for results.');
        }
        
        function runStressTest() {
            console.log('Running stress test...');
            // In real implementation, this would trigger the stress test
            alert('Stress test started. This may impact performance temporarily.');
        }
        
        // Initialize dashboard
        let dashboard;
        document.addEventListener('DOMContentLoaded', () => {
            dashboard = new PerformanceDashboard();
        });
    </script>
</body>
</html>