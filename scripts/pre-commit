#!/bin/bash
# Pre-commit hook for Diidemo.hr
# This hook runs formatting and linting before commits

set -e

echo "ğŸ” Running pre-commit checks..."

# Check if we're in the right directory
if [ ! -f "Makefile" ]; then
    echo "âŒ Please run from project root directory"
    exit 1
fi

# Format code
echo "ğŸ¨ Formatting code..."
make format-frontend > /dev/null 2>&1 || {
    echo "âŒ Frontend formatting failed"
    exit 1
}

make format-backend > /dev/null 2>&1 || {
    echo "âŒ Backend formatting failed"
    exit 1
}

# Run linting
echo "ğŸ” Running linters..."
make lint-frontend > /dev/null 2>&1 || {
    echo "âŒ Frontend linting failed"
    exit 1
}

make lint-backend > /dev/null 2>&1 || {
    echo "âŒ Backend linting failed"
    exit 1
}

# Run type checking
echo "ğŸ“ Type checking..."
make typecheck > /dev/null 2>&1 || {
    echo "âŒ Type checking failed"
    exit 1
}

# Run quick tests
echo "ğŸ§ª Running quick tests..."
make test-backend > /dev/null 2>&1 || {
    echo "âŒ Backend tests failed"
    exit 1
}

echo "âœ… All pre-commit checks passed!"
exit 0